<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8"/>
    <title>监控</title>

	<link href="css/third-party/bootstrap-datetimepicker.min.css" type="text/css" rel="stylesheet" />

	<link href="css/font/monitor/iconfont.css" rel="stylesheet" type="text/css" >

	<style>
		html{
			overflow: auto;
			width: 100%;
			height:100%;
		}
		.gf-form-input {
			display: block;
			width: 100%;
			font-size: 1rem;
			line-height: 1.35rem;
			color: #D8D9DA;
			background-color: #333;
			background-image: none;
			background-clip: padding-box;
			border: 1px solid #333;
			border-radius: 0 .1rem .1rem 0;
			box-shadow: inset 1px 0 0.3rem 0 rgba(150,150,150,.1);
			transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
		}
		.navbar>div>span{
			color: white;
		}
		.navbar-form .input-append,
		.navbar-form .input-prepend{
			margin: 5px 0px 0px 0px;!important;
		}
		.input-append>input{
			background-color: #333333;
			color:white;
		}
		.input-append .add-on,
		.input-prepend .add-on {
			background-color: #e17a1f;!important;
		}
		.add-on>i{
			color:white;
		}



	</style>

</head>

<body id="body">
	<div class="container" id="ems" style="background-color: #333;width: 100%;">
		<navbar class="navbar">
			<div class="navbar-inner navbar-form navbar-btn" >

				<span class="navbar-text pull-left">From &nbsp;</span>

				<div class="date input-append form_datetime pull-left" data-date="" data-date-format="yyyy-mm-dd HH:ii:ss" data-link-field="dtp_input1" style="">
					<input id="from_date" class="input-large" type="text" value="" >
					<span class="add-on"><i class="icon-th iconfont icon-rili"></i></span>
				</div>

				<span class="navbar-text pull-left" style=""> &nbsp; &nbsp;To &nbsp;</span>

				<div class="input-append date form_datetime pull-left " data-date="" data-date-format="yyyy-mm-dd HH:ii:ss" data-link-field="dtp_input1" style="">
					<input id="to_date" class="input-large " type="text" value="" >
					<span class="add-on"><i class="icon-th iconfont icon-rili"></i></span>
				</div>

				<span class="navbar-text pull-left" style=""> &nbsp; &nbsp;&nbsp;</span>

				<button id="searchMonitorButton" type="button" class="btn btn-success">Apply</button>

				<ul class="nav gf-timepicker-nav pull-right">
					<li class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown">
							<i class="iconfont icon-shizhong"></i>
							Last 30 Minites
							<b class="caret"></b>
						</a>
						<ul class="dropdown-menu">
							<li value="300"><a href="#">Last 5 Minites</a></li>
							<li value="1800"><a href="#">Last 30 Minites</a></li>
							<li value="3600"><a href="#">Last 1 Hours</a></li>
							<li value="21600"><a href="#">Last 6 Hours</a></li>
							<li value="86400"><a href="#">Last 24 Hours</a></li>
							<!--<li class="divider"></li>
							<li value="172800"><a href="#">Last 2Day</a></li>
							<li class="divider"></li>
							<li value=2159200"><a href="#">Last 1month</a></li>-->
						</ul>
					</li>
					<!--<li class="dashnav-refresh-action">
						<a>
							<i class="iconfont icon-icon-refresh"></i>
						</a>
					</li>-->

				</ul>
			</div>
		</navbar>
		<div class="row-fluid" style="margin-top:10px">
			<div id="em1" style="height: 300px;border:1px solid rgba(128, 128, 128, 0.35);border-radius: 4px" class="span6"></div>
			<div id="em2" style="height: 300px;border:1px solid rgba(128, 128, 128, 0.35);border-radius: 4px" class="span6"></div>
		</div>
		<div class="row-fluid" style="margin-top:10px">
			<div id="em3" style="height: 300px;border:1px solid rgba(128, 128, 128, 0.35);border-radius: 4px" class="span6"></div>
			<div id="em4" style="height: 300px;border:1px solid rgba(128, 128, 128, 0.35);border-radius: 4px" class="span6"></div>
		</div>
		<div class="row-fluid" style="margin-top:10px">
			<div id="em5" style="height: 300px;border:1px solid rgba(128, 128, 128, 0.35);border-radius: 4px" class="span6"></div>
		</div>

	</div>
</body>

<script src="js/third-party/echarts.min.js" type="text/javascript" ></script>
<script src="js/third-party/bootstrap-datetimepicker.min.js" type="text/javascript" charset="UTF-8"></script>
<script src="js/third-party/bootstrap-datetimepicker.zh-CN.js" type="text/javascript" charset="UTF-8"></script>
<!--echarts的暗色主题包-->
<script src="js/third-party/mytheme.js" type="text/javascript" ></script>

<script src="js/self/monitor.js" type="text/javascript"></script>

<script type="text/javascript" >

	var dropdownLi = $(".dropdown>ul>li>a"),
		dropdowna = $(".dropdown>a"),
		from_date = $("#from_date"),
		to_date    = $("#to_date"),
		ems         = $("#ems"),
		searchMonitorButton = $("#searchMonitorButton");

	dropdownLi.off("click").on("click",function(e){
		var $this = $(this),
				parentLi = $this.closest("li"),
				interval = parentLi.val(),
				now = new Date(),
				fromTime = new Date(now.getTime() - interval*1000);
		dropdowna.html('<i class="iconfont icon-shizhong"></i> ' + $this.text() + ' <b class="caret"></b>');
		from_date.val(fromTime.simpleFormat("yyyy-MM-dd hh:mm:ss"));
		to_date.val(now.simpleFormat("yyyy-MM-dd hh:mm:ss"));

		ems.mChart("reloadByTime",{startTS:fromTime.getTime(),endTS:now.getTime()});
	});

	searchMonitorButton.off("click").on("click",function(){
		var fromDate = strToDate(from_date.val()),
			toDate = strToDate(to_date.val());
		if(fromDate < toDate) {
			if(toDate.getTime() - fromDate.getTime() > 24*60*60*1000){
				return;
			}
			ems.mChart("reloadByTime",{interval:0,startTS:fromDate.getTime(),endTS:toDate.getTime()});
		}else{
			return;
		}
	});

	$('.form_datetime').datetimepicker({
		language:  'zh-CN',
		weekStart: 1,
		todayBtn:  1,
		autoclose: 1,
		todayHighlight: 1,
		startView: 2,
		minView: 2,
		forceParse: 0
	});

	function strToDate(str){
		str = str.replace("/-/g", "/");
		return new Date(str);
	}

	$("#ems").mChart(
			{
				startTS:(new Date()).getTime() - 30*60*1000,
				endTs : (new Date()).getTime(),
				instId:"c5da7600-2fae-c42c-b1b7-dcf09f387c29",
				theme:"mytheme",
				interval:10,
				config:[
					{echartOption:{title:{text:"CPU监控(单位%)"}},param:'CPU.Used',container:"em1"},
					{echartOption:{title:{text:"内存监控(单位KB)"},series:[{type:"bar"}]},param:'MEM.Used',container:"em2"},
					{echartOption:{title:{text:"磁盘总量(单位MB)"}},param:'DISK.Total',container:"em3"},
					{echartOption:{title:{text:"磁盘使用(单位MB)"}},param:'DISK.Used',container:"em4"},
					{echartOption:{title:{text:"磁盘可用(单位MB)"}},param:'DISK.Available',container:"em5"}
				]
			}
	);

</script>
</html>
