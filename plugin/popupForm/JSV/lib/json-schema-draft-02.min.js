(function(){var g={},b=require("./jsv").JSV,f,e,c,d,a;e={string:function(h,i){return h.getType()==="string"},number:function(h,i){return h.getType()==="number"},integer:function(h,i){return h.getType()==="number"&&h.getValue()%1===0},"boolean":function(h,i){return h.getType()==="boolean"},object:function(h,i){return h.getType()==="object"},array:function(h,i){return h.getType()==="array"},"null":function(h,i){return h.getType()==="null"},any:function(h,i){return true}};f=new b.Environment();f.setOption("defaultFragmentDelimiter","/");f.setOption("defaultSchemaURI","http://json-schema.org/schema#");c=f.createSchema({"$schema":"http://json-schema.org/hyper-schema#",id:"http://json-schema.org/schema#",type:"object",properties:{type:{type:["string","array"],items:{type:["string",{"$ref":"#"}]},optional:true,uniqueItems:true,"default":"any",parser:function(h,i){var j;if(h.getType()==="string"){return h.getValue()}else{if(h.getType()==="object"){return h.getEnvironment().createSchema(h,i.getEnvironment().findSchema(i.resolveURI("#")))}else{if(h.getType()==="array"){j=i.getValueOfProperty("parser");return b.mapArray(h.getProperties(),function(k){return j(k,i)})}}}return"any"},validator:function(r,k,s,m,q,t,h){var i=b.toArray(k.getAttribute("type")),p,n,o,l,j;if(r.getType()!=="undefined"&&i&&i.length){j=s.getValueOfProperty("typeValidators")||{};for(p=0,n=i.length;p<n;++p){o=i[p];if(b.isJSONSchema(o)){l=b.createObject(m);l.errors=[];l.validated=b.clone(m.validated);if(o.validate(r,l,q,t,h).errors.length===0){return true}}else{if(j[o]!==g[o]&&typeof j[o]==="function"){if(j[o](r,m)){return true}}else{return true}}}m.addError(r,k,"type","Instance is not a required type",i);return false}return true},typeValidators:e},properties:{type:"object",additionalProperties:{"$ref":"#"},optional:true,"default":{},parser:function(i,j,h){var k=i.getEnvironment(),l=j.getEnvironment();if(i.getType()==="object"){if(h){return k.createSchema(i.getProperty(h),l.findSchema(j.resolveURI("#")))}else{return b.mapObject(i.getProperties(),function(m){return k.createSchema(m,l.findSchema(j.resolveURI("#")))})}}return{}},validator:function(n,j,o,k,l,p,h){var i,m;if(n.getType()==="object"){i=j.getAttribute("properties");for(m in i){if(i[m]!==g[m]&&i[m]){i[m].validate(n.getProperty(m),k,n,j,m)}}}}},items:{type:[{"$ref":"#"},"array"],items:{"$ref":"#"},optional:true,"default":{},parser:function(h,i){if(h.getType()==="object"){return h.getEnvironment().createSchema(h,i.getEnvironment().findSchema(i.resolveURI("#")))}else{if(h.getType()==="array"){return b.mapArray(h.getProperties(),function(j){return j.getEnvironment().createSchema(j,i.getEnvironment().findSchema(i.resolveURI("#")))})}}return h.getEnvironment().createEmptySchema()},validator:function(r,i,s,j,q,t,h){var n,m,p,k,o,l;if(r.getType()==="array"){n=r.getProperties();m=i.getAttribute("items");l=i.getAttribute("additionalProperties");if(b.typeOf(m)==="array"){for(p=0,k=n.length;p<k;++p){o=m[p]||l;if(o!==false){o.validate(n[p],j,r,i,p)}else{j.addError(r,i,"additionalProperties","Additional items are not allowed",o)}}}else{o=m||l;for(p=0,k=n.length;p<k;++p){o.validate(n[p],j,r,i,p)}}}}},optional:{type:"boolean",optional:true,"default":false,parser:function(h,i){return !!h.getValue()},validator:function(h,m,j,i,l,n,k){if(h.getType()==="undefined"&&!m.getAttribute("optional")){i.addError(h,m,"optional","Property is required",false)}},validationRequired:true},additionalProperties:{type:[{"$ref":"#"},"boolean"],optional:true,"default":{},parser:function(h,i){if(h.getType()==="object"){return h.getEnvironment().createSchema(h,i.getEnvironment().findSchema(i.resolveURI("#")))}else{if(h.getType()==="boolean"&&h.getValue()===false){return false}}return h.getEnvironment().createEmptySchema()},validator:function(p,j,q,k,n,r,h){var l,i,m,o;if(p.getType()==="object"){l=j.getAttribute("additionalProperties");i=j.getAttribute("properties")||{};m=p.getProperties();for(o in m){if(m[o]!==g[o]&&m[o]&&!i[o]){if(b.isJSONSchema(l)){l.validate(m[o],k,p,j,o)}else{if(l===false){k.addError(p,j,"additionalProperties","Additional properties are not allowed",l)}}}}}}},requires:{type:["string",{"$ref":"#"}],optional:true,parser:function(h,i){if(h.getType()==="string"){return h.getValue()}else{if(h.getType()==="object"){return h.getEnvironment().createSchema(h,i.getEnvironment().findSchema(i.resolveURI("#")))}}},validator:function(h,n,j,i,m,o,k){var l;if(h.getType()!=="undefined"&&m&&m.getType()!=="undefined"){l=n.getAttribute("requires");if(typeof l==="string"){if(m.getProperty(l).getType()==="undefined"){i.addError(h,n,"requires",'Property requires sibling property "'+l+'"',l)}}else{if(b.isJSONSchema(l)){l.validate(m,i)}}}}},minimum:{type:"number",optional:true,parser:function(h,i){if(h.getType()==="number"){return h.getValue()}},validator:function(n,i,o,j,l,p,h){var k,m;if(n.getType()==="number"){k=i.getAttribute("minimum");m=i.getAttribute("minimumCanEqual");if(typeof k==="number"&&(n.getValue()<k||(m===false&&n.getValue()===k))){j.addError(n,i,"minimum","Number is less than the required minimum value",k)}}}},maximum:{type:"number",optional:true,parser:function(h,i){if(h.getType()==="number"){return h.getValue()}},validator:function(n,j,o,l,m,p,h){var i,k;if(n.getType()==="number"){i=j.getAttribute("maximum");k=j.getAttribute("maximumCanEqual");if(typeof i==="number"&&(n.getValue()>i||(k===false&&n.getValue()===i))){l.addError(n,j,"maximum","Number is greater than the required maximum value",i)}}}},minimumCanEqual:{type:"boolean",optional:true,requires:"minimum","default":true,parser:function(h,i){if(h.getType()==="boolean"){return h.getValue()}return true}},maximumCanEqual:{type:"boolean",optional:true,requires:"maximum","default":true,parser:function(h,i){if(h.getType()==="boolean"){return h.getValue()}return true}},minItems:{type:"integer",optional:true,minimum:0,"default":0,parser:function(h,i){if(h.getType()==="number"){return h.getValue()}return 0},validator:function(h,n,k,i,m,o,l){var j;if(h.getType()==="array"){j=n.getAttribute("minItems");if(typeof j==="number"&&h.getProperties().length<j){i.addError(h,n,"minItems","The number of items is less than the required minimum",j)}}}},maxItems:{type:"integer",optional:true,minimum:0,parser:function(h,i){if(h.getType()==="number"){return h.getValue()}},validator:function(h,n,j,i,m,o,l){var k;if(h.getType()==="array"){k=n.getAttribute("maxItems");if(typeof k==="number"&&h.getProperties().length>k){i.addError(h,n,"maxItems","The number of items is greater than the required maximum",k)}}}},uniqueItems:{type:"boolean",optional:true,"default":false,parser:function(h,i){return !!h.getValue()},validator:function(q,j,r,k,p,s,h){var o,n,l,m,i;if(q.getType()==="array"&&j.getAttribute("uniqueItems")){o=q.getProperties();for(n=0,l=o.length-1;n<l;++n){for(m=n+1,i=o.length;m<i;++m){if(o[n].equals(o[m])){k.addError(q,j,"uniqueItems","Array can only contain unique items",{x:n,y:m})}}}}}},pattern:{type:"string",optional:true,format:"regex",parser:function(h,i){if(h.getType()==="string"){return h.getValue()}},validator:function(n,i,o,j,m,p,h){var l;try{l=new RegExp(i.getAttribute("pattern"));if(n.getType()==="string"&&l&&!l.test(n.getValue())){j.addError(n,i,"pattern","String does not match pattern",l.toString())}}catch(k){j.addError(n,i,"pattern","Invalid pattern",k)}}},minLength:{type:"integer",optional:true,minimum:0,"default":0,parser:function(h,i){if(h.getType()==="number"){return h.getValue()}return 0},validator:function(h,n,k,i,m,o,l){var j;if(h.getType()==="string"){j=n.getAttribute("minLength");if(typeof j==="number"&&h.getValue().length<j){i.addError(h,n,"minLength","String is less than the required minimum length",j)}}}},maxLength:{type:"integer",optional:true,parser:function(h,i){if(h.getType()==="number"){return h.getValue()}},validator:function(h,n,k,j,m,o,l){var i;if(h.getType()==="string"){i=n.getAttribute("maxLength");if(typeof i==="number"&&h.getValue().length>i){j.addError(h,n,"maxLength","String is greater than the required maximum length",i)}}}},"enum":{type:"array",optional:true,minItems:1,uniqueItems:true,parser:function(h,i){if(h.getType()==="array"){return h.getValue()}},validator:function(o,j,p,k,n,q,i){var h,m,l;if(o.getType()!=="undefined"){h=j.getAttribute("enum");if(h){for(m=0,l=h.length;m<l;++m){if(o.equals(h[m])){return true}}k.addError(o,j,"enum","Instance is not one of the possible values",h)}}}},title:{type:"string",optional:true},description:{type:"string",optional:true},format:{type:"string",optional:true,parser:function(h,i){if(h.getType()==="string"){return h.getValue()}},validator:function(n,i,o,j,l,p,h){var k,m;if(n.getType()==="string"){k=i.getAttribute("format");m=o.getValueOfProperty("formatValidators");if(typeof k==="string"&&m[k]!==g[k]&&typeof m[k]==="function"&&!m[k].call(this,n,j)){j.addError(n,i,"format","String is not in the required format",k)}}},formatValidators:{}},contentEncoding:{type:"string",optional:true},"default":{type:"any",optional:true},divisibleBy:{type:"number",minimum:0,minimumCanEqual:false,optional:true,parser:function(h,i){if(h.getType()==="number"){return h.getValue()}},validator:function(h,m,j,i,l,o,k){var n;if(h.getType()==="number"){n=m.getAttribute("divisibleBy");if(n===0){i.addError(h,m,"divisibleBy","Nothing is divisible by 0",n)}else{if(n!==1&&((h.getValue()/n)%1)!==0){i.addError(h,m,"divisibleBy","Number is not divisible by "+n,n)}}}}},disallow:{type:["string","array"],items:{type:"string"},optional:true,uniqueItems:true,parser:function(h,i){if(h.getType()==="string"||h.getType()==="array"){return h.getValue()}},validator:function(q,j,r,k,o,s,h){var m=b.toArray(j.getAttribute("disallow")),n,l,p,i;if(q.getType()!=="undefined"&&m&&m.length){i=r.getValueOfProperty("typeValidators")||{};for(n=0,l=m.length;n<l;++n){p=m[n];if(i[p]!==g[p]&&typeof i[p]==="function"){if(i[p](q,k)){k.addError(q,j,"disallow","Instance is a disallowed type",m);return false}}}return true}return true},typeValidators:e},"extends":{type:[{"$ref":"#"},"array"],items:{"$ref":"#"},optional:true,"default":{},parser:function(h,i){if(h.getType()==="object"){return h.getEnvironment().createSchema(h,i.getEnvironment().findSchema(i.resolveURI("#")))}else{if(h.getType()==="array"){return b.mapArray(h.getProperties(),function(j){return j.getEnvironment().createSchema(j,i.getEnvironment().findSchema(i.resolveURI("#")))})}}},validator:function(o,i,p,j,n,q,h){var l=i.getAttribute("extends"),m,k;if(l){if(b.isJSONSchema(l)){l.validate(o,j,n,q,h)}else{if(b.typeOf(l)==="array"){for(m=0,k=l.length;m<k;++m){l[m].validate(o,j,n,q,h)}}}}}}},optional:true,"default":{},fragmentResolution:"slash-delimited",parser:function(h,i){if(h.getType()==="object"){return h.getEnvironment().createSchema(h,i)}},validator:function(p,j,q,k,o,r,i){var s=j.getPropertyNames(),n,l,m=q.getAttribute("properties"),h;for(n in m){if(m[n]!==g[n]&&m[n].getValueOfProperty("validationRequired")){b.pushUnique(s,n)}}for(n=0,l=s.length;n<l;++n){if(m[s[n]]!==g[s[n]]){h=m[s[n]].getValueOfProperty("validator");if(typeof h==="function"){h(p,j,m[s[n]],k,o,r,i)}}}},initializer:function(i){var j,k,h;j=i._schema.getLink("describedby",i);if(j&&i._schema._uri!==j){i.setReference("describedby",j)}j=i._schema.getLink("self",i);if(b.typeOf(j)==="string"){i._uri=b.formatURI(j)}j=i._schema.getLink("full",i);if(j&&i._uri!==j){i.setReference("full",j)}k=i.getAttribute("extends");if(b.isJSONSchema(k)){h=b.inherits(k,i,true);i=i._env.createSchema(h,i._schema,i._uri)}return i}},true,"http://json-schema.org/schema#");d=f.createSchema(b.inherits(c,f.createSchema({"$schema":"http://json-schema.org/hyper-schema#",id:"http://json-schema.org/hyper-schema#",properties:{links:{type:"array",items:{"$ref":"links#"},optional:true,parser:function(k,m,j){var l,i=m.getValueOfProperty("items")["$ref"],n=m.getEnvironment().findSchema(i),h=n&&n.getValueOfProperty("parser");j=b.toArray(j);if(typeof h==="function"){l=b.mapArray(k.getProperties(),function(o){return h(o,n)})}else{l=b.toArray(k.getValue())}if(j[0]){l=b.filterArray(l,function(o){return o.rel===j[0]})}if(j[1]){l=b.mapArray(l,function(q){var o=j[1],p=q.href;p=p.replace(/\{(.+)\}/g,function(w,v,u,r){var t;if(v==="-this"){t=o.getValue()}else{t=o.getValueOfProperty(v)}return t!==undefined?String(t):""});return p?b.formatURI(o.resolveURI(p)):p})}return l}},fragmentResolution:{type:"string",optional:true,"default":"slash-delimited"},root:{type:"boolean",optional:true,"default":false},readonly:{type:"boolean",optional:true,"default":false},pathStart:{type:"string",optional:true,format:"uri",validator:function(h,m,j,i,l,o,k){var n;if(h.getType()!=="undefined"){n=m.getAttribute("pathStart");if(typeof n==="string"){if(h.getURI().indexOf(n)!==0){i.addError(h,m,"pathStart","Instance's URI does not start with "+n,n)}}}}},mediaType:{type:"string",optional:true,format:"media-type"},alternate:{type:"array",items:{"$ref":"#"},optional:true}},links:[{href:"{$ref}",rel:"full"},{href:"{$schema}",rel:"describedby"},{href:"{id}",rel:"self"}]},c),true),true,"http://json-schema.org/hyper-schema#");f.setOption("defaultSchemaURI","http://json-schema.org/hyper-schema#");a=f.createSchema({"$schema":"http://json-schema.org/hyper-schema#",id:"http://json-schema.org/links#",type:"object",properties:{href:{type:"string"},rel:{type:"string"},targetSchema:{"$ref":"hyper-schema#",parser:d.getAttribute("parser")},method:{type:"string","default":"GET",optional:true},enctype:{type:"string",requires:"method",optional:true},properties:{type:"object",additionalProperties:{"$ref":"hyper-schema#"},optional:true,parser:function(j,k,i){var l=j.getEnvironment(),m=k.getEnvironment(),h=k.getValueOfProperty("additionalProperties")["$ref"];if(j.getType()==="object"){if(i){return l.createSchema(j.getProperty(i),m.findSchema(k.resolveURI(h)))}else{return b.mapObject(j.getProperties(),function(n){return l.createSchema(n,m.findSchema(k.resolveURI(h)))})}}}}},parser:function(h,j){var i=j.getProperty("properties");if(h.getType()==="object"){return b.mapObject(h.getProperties(),function(m,l){var k=i.getProperty(l),n=k&&k.getValueOfProperty("parser");if(typeof n==="function"){return n(m,k)}return m.getValue()})}return h.getValue()}},d,"http://json-schema.org/links#");b.registerEnvironment("json-schema-draft-02",f);if(!b.getDefaultEnvironmentID()||b.getDefaultEnvironmentID()==="json-schema-draft-01"){b.setDefaultEnvironmentID("json-schema-draft-02")}}());