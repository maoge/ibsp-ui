(function(){var o=require("../uri"),q=o.URI,m=o.pctEncChar,w="(?:[0-9A-Za-z][0-9A-Za-z\\-]{1,31})",u="(?:\\%[0-9A-Fa-f]{2})",t="[0-9A-Za-z\\(\\)\\+\\,\\-\\.\\:\\=\\@\\;\\$\\_\\!\\*\\'\\/\\?\\#]",x="(?:(?:"+u+"|"+t+")+)",p=new RegExp("^urn\\:("+w+")$"),s=new RegExp("^("+w+")\\:("+x+")$"),v=/^([^\:]+)\:(.*)/,r=/[\x00-\x20\\\"\&\<\>\[\]\^\`\{\|\}\~\x7F-\xFF]/g,n=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/;q.SCHEMES.urn={parse:function(c,e){var b=c.path.match(s),a,d;if(!b){if(!e.tolerant){c.errors.push("URN is not strictly valid.")}b=c.path.match(v)}if(b){a="urn:"+b[1].toLowerCase();d=q.SCHEMES[a];if(!d){d=q.SCHEMES[a]={}}if(!d.serialize){d.serialize=q.SCHEMES.urn.serialize}c.scheme=a;c.path=b[2];if(d.parse){d.parse(c,e)}}else{c.errors.push("URN can not be parsed.")}return c},serialize:function(c,d){var a=c.scheme||d.scheme,b;if(a&&a!=="urn"){var b=a.match(p);if(!b){b=["urn:"+a,a]}c.scheme="urn";c.path=b[1]+":"+(c.path?c.path.replace(r,m):"")}return c}};q.SCHEMES["urn:uuid"]={serialize:function(b,a){if(!a.tolerant&&(!b.path||!b.path.match(n))){b.scheme=undefined}return q.SCHEMES.urn.serialize(b,a)}}}());