(function(){var j=require("../uri"),h=j.URI,l=j.pctEncChar,b="(?:[0-9A-Za-z][0-9A-Za-z\\-]{1,31})",d="(?:\\%[0-9A-Fa-f]{2})",e="[0-9A-Za-z\\(\\)\\+\\,\\-\\.\\:\\=\\@\\;\\$\\_\\!\\*\\'\\/\\?\\#]",a="(?:(?:"+d+"|"+e+")+)",i=new RegExp("^urn\\:("+b+")$"),f=new RegExp("^("+b+")\\:("+a+")$"),c=/^([^\:]+)\:(.*)/,g=/[\x00-\x20\\\"\&\<\>\[\]\^\`\{\|\}\~\x7F-\xFF]/g,k=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/;h.SCHEMES.urn={parse:function(p,n){var q=p.path.match(f),m,o;if(!q){if(!n.tolerant){p.errors.push("URN is not strictly valid.")}q=p.path.match(c)}if(q){m="urn:"+q[1].toLowerCase();o=h.SCHEMES[m];if(!o){o=h.SCHEMES[m]={}}if(!o.serialize){o.serialize=h.SCHEMES.urn.serialize}p.scheme=m;p.path=q[2];if(o.parse){o.parse(p,n)}}else{p.errors.push("URN can not be parsed.")}return p},serialize:function(o,n){var m=o.scheme||n.scheme,p;if(m&&m!=="urn"){var p=m.match(i);if(!p){p=["urn:"+m,m]}o.scheme="urn";o.path=p[1]+":"+(o.path?o.path.replace(g,l):"")}return o}};h.SCHEMES["urn:uuid"]={serialize:function(n,m){if(!m.tolerant&&(!n.path||!n.path.match(k))){n.scheme=undefined}return h.SCHEMES.urn.serialize(n,m)}}}());