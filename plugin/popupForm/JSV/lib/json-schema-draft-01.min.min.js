(function(){var j={},h=require("./jsv").JSV,k,l,n,m,i;l={string:function(b,a){return b.getType()==="string"},number:function(b,a){return b.getType()==="number"},integer:function(b,a){return b.getType()==="number"&&b.getValue()%1===0},"boolean":function(b,a){return b.getType()==="boolean"},object:function(b,a){return b.getType()==="object"},array:function(b,a){return b.getType()==="array"},"null":function(b,a){return b.getType()==="null"},any:function(b,a){return true}};k=new h.Environment();k.setOption("defaultFragmentDelimiter",".");k.setOption("defaultSchemaURI","http://json-schema.org/schema#");n=k.createSchema({"$schema":"http://json-schema.org/hyper-schema#",id:"http://json-schema.org/schema#",type:"object",properties:{type:{type:["string","array"],items:{type:["string",{"$ref":"#"}]},optional:true,uniqueItems:true,"default":"any",parser:function(c,b){var a;if(c.getType()==="string"){return c.getValue()}else{if(c.getType()==="object"){return c.getEnvironment().createSchema(c,b.getEnvironment().findSchema(b.resolveURI("#")))}else{if(c.getType()==="array"){a=b.getValueOfProperty("parser");return h.mapArray(c.getProperties(),function(d){return a(d,b)})}}}return"any"},validator:function(a,u,z,f,b,y,x){var w=h.toArray(u.getAttribute("type")),c,e,d,g,v;if(a.getType()!=="undefined"&&w&&w.length){v=z.getValueOfProperty("typeValidators")||{};for(c=0,e=w.length;c<e;++c){d=w[c];if(h.isJSONSchema(d)){g=h.createObject(f);g.errors=[];g.validated=h.clone(f.validated);if(d.validate(a,g,b,y,x).errors.length===0){return true}}else{if(v[d]!==j[d]&&typeof v[d]==="function"){if(v[d](a,f)){return true}}else{return true}}}f.addError(a,u,"type","Instance is not a required type",w);return false}return true},typeValidators:l},properties:{type:"object",additionalProperties:{"$ref":"#"},optional:true,"default":{},parser:function(d,c,e){var b=d.getEnvironment(),a=c.getEnvironment();if(d.getType()==="object"){if(e){return b.createSchema(d.getProperty(e),a.findSchema(c.resolveURI("#")))}else{return h.mapObject(d.getProperties(),function(f){return b.createSchema(f,a.findSchema(c.resolveURI("#")))})}}return{}},validator:function(c,g,b,f,e,a,r){var q,d;if(c.getType()==="object"){q=g.getAttribute("properties");for(d in q){if(q[d]!==j[d]&&q[d]){q[d].validate(c.getProperty(d),f,c,g,d)}}}}},items:{type:[{"$ref":"#"},"array"],items:{"$ref":"#"},optional:true,"default":{},parser:function(b,a){if(b.getType()==="object"){return b.getEnvironment().createSchema(b,a.getEnvironment().findSchema(a.resolveURI("#")))}else{if(b.getType()==="array"){return h.mapArray(b.getProperties(),function(c){return c.getEnvironment().createSchema(c,a.getEnvironment().findSchema(a.resolveURI("#")))})}}return b.getEnvironment().createEmptySchema()},validator:function(a,w,z,v,b,y,x){var e,f,c,u,d,g;if(a.getType()==="array"){e=a.getProperties();f=w.getAttribute("items");g=w.getAttribute("additionalProperties");if(h.typeOf(f)==="array"){for(c=0,u=e.length;c<u;++c){d=f[c]||g;if(d!==false){d.validate(e[c],v,a,w,c)}else{v.addError(a,w,"additionalProperties","Additional items are not allowed",d)}}}else{d=f||g;for(c=0,u=e.length;c<u;++c){d.validate(e[c],v,a,w,c)}}}}},optional:{type:"boolean",optional:true,"default":false,parser:function(b,a){return !!b.getValue()},validator:function(f,a,d,e,b,g,c){if(f.getType()==="undefined"&&!a.getAttribute("optional")){e.addError(f,a,"optional","Property is required",false)}},validationRequired:true},additionalProperties:{type:[{"$ref":"#"},"boolean"],optional:true,"default":{},parser:function(b,a){if(b.getType()==="object"){return b.getEnvironment().createSchema(b,a.getEnvironment().findSchema(a.resolveURI("#")))}else{if(b.getType()==="boolean"&&b.getValue()===false){return false}}return b.getEnvironment().createEmptySchema()},validator:function(c,t,b,s,e,a,v){var g,u,f,d;if(c.getType()==="object"){g=t.getAttribute("additionalProperties");u=t.getAttribute("properties")||{};f=c.getProperties();for(d in f){if(f[d]!==j[d]&&f[d]&&!u[d]){if(h.isJSONSchema(g)){g.validate(f[d],s,c,t,d)}else{if(g===false){s.addError(c,t,"additionalProperties","Additional properties are not allowed",g)}}}}}}},requires:{type:["string",{"$ref":"#"}],optional:true,parser:function(b,a){if(b.getType()==="string"){return b.getValue()}else{if(b.getType()==="object"){return b.getEnvironment().createSchema(b,a.getEnvironment().findSchema(a.resolveURI("#")))}}},validator:function(f,p,d,e,a,g,c){var b;if(f.getType()!=="undefined"&&a&&a.getType()!=="undefined"){b=p.getAttribute("requires");if(typeof b==="string"){if(a.getProperty(b).getType()==="undefined"){e.addError(f,p,"requires",'Property requires sibling property "'+b+'"',b)}}else{if(h.isJSONSchema(b)){b.validate(a,e)}}}}},minimum:{type:"number",optional:true,parser:function(b,a){if(b.getType()==="number"){return b.getValue()}},validator:function(c,q,b,g,e,a,r){var f,d;if(c.getType()==="number"){f=q.getAttribute("minimum");d=q.getAttribute("minimumCanEqual");if(typeof f==="number"&&(c.getValue()<f||(d===false&&c.getValue()===f))){g.addError(c,q,"minimum","Number is less than the required minimum value",f)}}}},maximum:{type:"number",optional:true,parser:function(b,a){if(b.getType()==="number"){return b.getValue()}},validator:function(c,g,b,e,d,a,r){var q,f;if(c.getType()==="number"){q=g.getAttribute("maximum");f=g.getAttribute("maximumCanEqual");if(typeof q==="number"&&(c.getValue()>q||(f===false&&c.getValue()===q))){e.addError(c,g,"maximum","Number is greater than the required maximum value",q)}}}},minimumCanEqual:{type:"boolean",optional:true,requires:"minimum","default":true,parser:function(b,a){if(b.getType()==="boolean"){return b.getValue()}return true}},maximumCanEqual:{type:"boolean",optional:true,requires:"maximum","default":true,parser:function(b,a){if(b.getType()==="boolean"){return b.getValue()}return true}},minItems:{type:"integer",optional:true,minimum:0,"default":0,parser:function(b,a){if(b.getType()==="number"){return b.getValue()}return 0},validator:function(f,p,c,e,a,g,b){var d;if(f.getType()==="array"){d=p.getAttribute("minItems");if(typeof d==="number"&&f.getProperties().length<d){e.addError(f,p,"minItems","The number of items is less than the required minimum",d)}}}},maxItems:{type:"integer",optional:true,minimum:0,parser:function(b,a){if(b.getType()==="number"){return b.getValue()}},validator:function(f,p,d,e,a,g,b){var c;if(f.getType()==="array"){c=p.getAttribute("maxItems");if(typeof c==="number"&&f.getProperties().length>c){e.addError(f,p,"maxItems","The number of items is greater than the required maximum",c)}}}},pattern:{type:"string",optional:true,format:"regex",parser:function(b,a){if(b.getType()==="string"){return b.getValue()}},validator:function(c,q,b,g,d,a,r){var e;try{e=new RegExp(q.getAttribute("pattern"));if(c.getType()==="string"&&e&&!e.test(c.getValue())){g.addError(c,q,"pattern","String does not match pattern",e.toString())}}catch(f){g.addError(c,q,"pattern","Invalid pattern",f)}}},minLength:{type:"integer",optional:true,minimum:0,"default":0,parser:function(b,a){if(b.getType()==="number"){return b.getValue()}return 0},validator:function(f,p,c,e,a,g,b){var d;if(f.getType()==="string"){d=p.getAttribute("minLength");if(typeof d==="number"&&f.getValue().length<d){e.addError(f,p,"minLength","String is less than the required minimum length",d)}}}},maxLength:{type:"integer",optional:true,parser:function(b,a){if(b.getType()==="number"){return b.getValue()}},validator:function(f,p,c,d,a,g,b){var e;if(f.getType()==="string"){e=p.getAttribute("maxLength");if(typeof e==="number"&&f.getValue().length>e){d.addError(f,p,"maxLength","String is greater than the required maximum length",e)}}}},"enum":{type:"array",optional:true,minItems:1,uniqueItems:true,parser:function(b,a){if(b.getType()==="array"){return b.getValue()}},validator:function(c,r,b,g,d,a,s){var t,e,f;if(c.getType()!=="undefined"){t=r.getAttribute("enum");if(t){for(e=0,f=t.length;e<f;++e){if(c.equals(t[e])){return true}}g.addError(c,r,"enum","Instance is not one of the possible values",t)}}}},title:{type:"string",optional:true},description:{type:"string",optional:true},format:{type:"string",optional:true,parser:function(b,a){if(b.getType()==="string"){return b.getValue()}},validator:function(c,q,b,g,e,a,r){var f,d;if(c.getType()==="string"){f=q.getAttribute("format");d=b.getValueOfProperty("formatValidators");if(typeof f==="string"&&d[f]!==j[f]&&typeof d[f]==="function"&&!d[f].call(this,c,g)){g.addError(c,q,"format","String is not in the required format",f)}}},formatValidators:{}},contentEncoding:{type:"string",optional:true},"default":{type:"any",optional:true},maxDecimal:{type:"integer",optional:true,minimum:0,parser:function(b,a){if(b.getType()==="number"){return b.getValue()}},validator:function(c,g,b,e,d,a,r){var f,q;if(c.getType()==="number"){f=g.getAttribute("maxDecimal");if(typeof f==="number"){q=c.getValue().toString(10).split(".")[1];if(q&&q.length>f){e.addError(c,g,"maxDecimal","The number of decimal places is greater than the allowed maximum",f)}}}}},disallow:{type:["string","array"],items:{type:"string"},optional:true,uniqueItems:true,parser:function(b,a){if(b.getType()==="string"||b.getType()==="array"){return b.getValue()}},validator:function(b,u,a,t,d,x,w){var f=h.toArray(u.getAttribute("disallow")),e,g,c,v;if(b.getType()!=="undefined"&&f&&f.length){v=a.getValueOfProperty("typeValidators")||{};for(e=0,g=f.length;e<g;++e){c=f[e];if(v[c]!==j[c]&&typeof v[c]==="function"){if(v[c](b,t)){t.addError(b,u,"disallow","Instance is a disallowed type",f);return false}}}return true}return true},typeValidators:l},"extends":{type:[{"$ref":"#"},"array"],items:{"$ref":"#"},optional:true,"default":{},parser:function(b,a){if(b.getType()==="object"){return b.getEnvironment().createSchema(b,a.getEnvironment().findSchema(a.resolveURI("#")))}else{if(b.getType()==="array"){return h.mapArray(b.getProperties(),function(c){return c.getEnvironment().createSchema(c,a.getEnvironment().findSchema(a.resolveURI("#")))})}}},validator:function(c,s,b,r,d,a,t){var f=s.getAttribute("extends"),e,g;if(f){if(h.isJSONSchema(f)){f.validate(c,r,d,a,t)}else{if(h.typeOf(f)==="array"){for(e=0,g=f.length;e<g;++e){f[e].validate(c,r,d,a,t)}}}}}}},optional:true,"default":{},fragmentResolution:"dot-delimited",parser:function(b,a){if(b.getType()==="object"){return b.getEnvironment().createSchema(b,a)}},validator:function(c,u,b,t,d,a,v){var x=u.getPropertyNames(),e,g,f=b.getAttribute("properties"),w;for(e in f){if(f[e]!==j[e]&&f[e].getValueOfProperty("validationRequired")){h.pushUnique(x,e)}}for(e=0,g=x.length;e<g;++e){if(f[x[e]]!==j[x[e]]){w=f[x[e]].getValueOfProperty("validator");if(typeof w==="function"){w(c,u,f[x[e]],t,d,a,v)}}}},initializer:function(c){var b,a,d;b=c._schema.getLink("describedby",c);if(b&&c._schema._uri!==b){c.setReference("describedby",b)}b=c._schema.getLink("self",c);if(h.typeOf(b)==="string"){c._uri=h.formatURI(b)}b=c._schema.getLink("full",c);if(b&&c._uri!==b){c.setReference("full",b)}a=c.getAttribute("extends");if(h.isJSONSchema(a)){d=h.inherits(a,c,true);c=c._env.createSchema(d,c._schema,c._uri)}return c}},true,"http://json-schema.org/schema#");m=k.createSchema(h.inherits(n,k.createSchema({"$schema":"http://json-schema.org/hyper-schema#",id:"http://json-schema.org/hyper-schema#",properties:{links:{type:"array",items:{"$ref":"links#"},optional:true,parser:function(c,a,d){var b,e=a.getValueOfProperty("items")["$ref"],g=a.getEnvironment().findSchema(e),f=g&&g.getValueOfProperty("parser");d=h.toArray(d);if(typeof f==="function"){b=h.mapArray(c.getProperties(),function(p){return f(p,g)})}else{b=h.toArray(c.getValue())}if(d[0]){b=h.filterArray(b,function(p){return p.rel===d[0]})}if(d[1]){b=h.mapArray(b,function(r){var t=d[1],s=r.href;s=s.replace(/\{(.+)\}/g,function(o,p,q,y){var x;if(p==="-this"){x=t.getValue()}else{x=t.getValueOfProperty(p)}return x!==undefined?String(x):""});return s?h.formatURI(t.resolveURI(s)):s})}return b}},fragmentResolution:{type:"string",optional:true,"default":"dot-delimited"},root:{type:"boolean",optional:true,"default":false},readonly:{type:"boolean",optional:true,"default":false},pathStart:{type:"string",optional:true,format:"uri",validator:function(f,a,d,e,b,g,c){var p;if(f.getType()!=="undefined"){p=a.getAttribute("pathStart");if(typeof p==="string"){if(f.getURI().indexOf(p)!==0){e.addError(f,a,"pathStart","Instance's URI does not start with "+p,p)}}}}},mediaType:{type:"string",optional:true,format:"media-type"},alternate:{type:"array",items:{"$ref":"#"},optional:true}},links:[{href:"{$ref}",rel:"full"},{href:"{$schema}",rel:"describedby"},{href:"{id}",rel:"self"}]},n),true),true,"http://json-schema.org/hyper-schema#");k.setOption("defaultSchemaURI","http://json-schema.org/hyper-schema#");i=k.createSchema({"$schema":"http://json-schema.org/hyper-schema#",id:"http://json-schema.org/links#",type:"object",properties:{href:{type:"string"},rel:{type:"string"},method:{type:"string","default":"GET",optional:true},enctype:{type:"string",requires:"method",optional:true},properties:{type:"object",additionalProperties:{"$ref":"hyper-schema#"},optional:true,parser:function(d,c,e){var b=d.getEnvironment(),a=c.getEnvironment(),f=c.getValueOfProperty("additionalProperties")["$ref"];if(d.getType()==="object"){if(e){return b.createSchema(d.getProperty(e),a.findSchema(c.resolveURI(f)))}else{return h.mapObject(d.getProperties(),function(g){return b.createSchema(g,a.findSchema(c.resolveURI(f)))})}}}}},parser:function(c,a){var b=a.getProperty("properties");if(c.getType()==="object"){return h.mapObject(c.getProperties(),function(d,e){var f=b.getProperty(e),g=f&&f.getValueOfProperty("parser");if(typeof g==="function"){return g(d,f)}return d.getValue()})}return c.getValue()}},m,"http://json-schema.org/links#");h.registerEnvironment("json-schema-draft-00",k);h.registerEnvironment("json-schema-draft-01",h.createEnvironment("json-schema-draft-00"));if(!h.getDefaultEnvironmentID()){h.setDefaultEnvironmentID("json-schema-draft-01")}}());