<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>test</title>
    <link rel="stylesheet"  href="css/popupForm.css" type="text/css" />

    <script type="text/javascript" src="JSV/lib/uri/uri.js"></script>
    <script type="text/javascript" src="JSV/lib/jsv.js"></script>
    <script type="text/javascript" src="JSV/lib/json-schema-draft-03.js"></script>
    <script type="text/javascript" src="jquery-1.7.1.min.js"></script>
    <script type="text/javascript" src="popupForm.js"></script>

</head>
<body>
    <a href="#" id="testa">
        点击我
    </a>
<!--    <a href="#" id="testab">
        发送请求
    </a>-->
</body>
<script type="text/javascript">
    var env = JSV.createEnvironment("json-schema-draft-03");
    var schema;
    var popupWindows;
    $.get("schema/tidb.new.schema",function(data){
        schema = JSON.parse(data);
        window.schema = schema;
    });
    $('#testa').click(function(){
        // $.popupForm(type,url,schema,successCallBack,errorCallBack)
        popupWindows || (popupWindows = $.popupForm("DB_TIKV",'http://127.0.0.1:8888/app/hello',window.schema,function(){
            alert("提交成功");
        },function(msg){
            alert("提交失败");
        }));
        //popupWindows.show() 不带参数的 默认显示
        popupWindows.show({"TIKV_ID":"0a161eb3-3434-06a2-45d0-02b1ed7122e8","TIKV_NAME":"TiKV","IP":"192.168.14.206","PORT":3333});
    });


    /*$('#testab').click(function(){
        $.post("http://192.168.37.175:9991/tidbsvr/saveTiDBTopo",
                {'TIDB_JSON':'{"DB_SERV_CONTAINER":{"DB_SVC_CONTAINER_ID":"0a161eb3-3434-06a2-45d0-02b1ed7122e8","DB_SVC_CONTAINER_NAME":"集群","DB_TIDB_CONTAINER":{"TIDB_CONTAINER_ID":"e0a56059-780b-ba2d-5df0-d33a51809732","TIDB_CONTAINER_NAME":"TiDB集群","POS":{"x":600,"y":103,"row":1,"col":5},"DB_TIDB":[{"TIDB_ID":"6a607072-0d26-ceac-bd4f-04120e6446f2","TIDB_NAME":"TiDB","IP":"","PORT":"","STAT_PORT":""},{"TIDB_ID":"0e8cfcbd-aaa3-b5b0-8066-f27c53b7b806","TIDB_NAME":"TiDB","IP":"","PORT":"","STAT_PORT":""}]},"DB_TIKV_CONTAINER":{"TIKV_CONTAINER_ID":"a395f9de-9074-a3d1-258a-fa12d5c07a41","TIKV_CONTAINER_NAME":"TiKV集群","POS":{"x":600,"y":309,"row":1,"col":5},"DB_TIKV":[{"TIKV_ID":"51d152a8-8f7b-a296-b233-446d9ee6ac77","TIKV_NAME":"TiKV","IP":"","PORT":""},{"TIKV_ID":"93ec410c-f94f-c3ff-9156-170ed2a939e1","TIKV_NAME":"TiKV","IP":"","PORT":""},{"TIKV_ID":"5091bb19-e8e6-2aa9-f189-f5519ed9a4aa","TIKV_NAME":"TiKV","IP":"","PORT":""}]},"DB_PD_CONTAINER":{"PD_CONTAINER_ID":"7cea12fb-b1fe-7046-1842-9853780ca329","PD_CONTAINER_NAME":"PD集群","POS":{"x":144,"y":180,"row":2,"col":3},"DB_PD":[{"PD_ID":"a4b10cd4-f7d4-da32-48ae-1ea68ea89e56","PD_NAME":"PD","IP":"","PORT":"","CLUSTER_PORT":"7777"},{"PD_ID":"9c59c674-668c-4d79-5007-c2e43e7f14cb","PD_NAME":"PD","IP":"","PORT":"","CLUSTER_PORT":"7778"},{"PD_ID":"c3403a0a-e1ac-3b7a-56f2-e94a214f8f74","PD_NAME":"PD","IP":"","PORT":"","CLUSTER_PORT":"7779"}]},"DB_COLLECTD":{"COLLECTD_ID":"d3a9c6dd-d945-fa9b-8515-c6aef37b7c58","COLLECTD_NAME":"collectd","IP":"","PORT":"","POS":{"x":393,"y":84}}}}'},
                function(data){console.log(data)});
    });*/
    /*var res ={};
    function getAllType(rootkey,properties,type,res){
        if(type === 'object'){
            for(var key in properties){
                var ele = properties[key];
                var obj = {ele:getAllType(key,ele['properties'],ele['type'],{})};
            }
        }
        if(type === 'array'){

        }else{
            res[rootKey] = type;
        }
    }*/

</script>
</html>