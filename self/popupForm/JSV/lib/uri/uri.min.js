if(typeof exports==="undefined"){exports={}}if(typeof require!=="function"){require=function(a){return exports}}(function(){var B=function(az){var aB=arguments[0],ay=1,aA=arguments[ay];while(aA){aB=aB.slice(0,-1)+aA.slice(1);aA=arguments[++ay]}return aB},r=function(ay){return"(?:"+ay+")"},c="[A-Za-z]",I="[\\x0D]",f="[0-9]",ab="[\\x22]",ao=B(f,"[A-Fa-f]"),ae="[\\x0A]",Y="[\\x20]",ag=r("%"+ao+ao),ap="[\\:\\/\\?\\#\\[\\]\\@]",ah="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",F=B(ap,ah),M=B(c,f,"[\\-\\.\\_\\~]"),d=r(c+B(c,f,"[\\+\\-\\.]")+"*"),l=r(r(ag+"|"+B(M,ah,"[\\:]"))+"*"),Q=r(r("25[0-5]")+"|"+r("2[0-4]"+f)+"|"+r("1"+f+f)+"|"+r("[1-9]"+f)+"|"+f),an=r(Q+"\\."+Q+"\\."+Q+"\\."+Q),H=r(ao+"{1,4}"),ar=r(r(H+"\\:"+H)+"|"+an),al=r(B(M,ah,"[\\:]")+"+"),N=r("v"+ao+"+\\."+B(M,ah,"[\\:]")+"+"),am=r("\\["+r(al+"|"+N)+"\\]"),ax=r(r(ag+"|"+B(M,ah))+"*"),e=r(am+"|"+an+"|"+ax),U=r(f+"*"),h=r(r(l+"@")+"?"+e+r("\\:"+U)+"?"),n=r(ag+"|"+B(M,ah,"[\\:\\@]")),S=r(n+"*"),af=r(n+"+"),ad=r(r(ag+"|"+B(M,ah,"[\\@]"))+"+"),a=r(r("\\/"+S)+"*"),m=r("\\/"+r(af+a)+"?"),at=r(ad+a),aw=r(af+a),b=r(""),i=r(a+"|"+m+"|"+at+"|"+aw+"|"+b),o=r(r(n+"|[\\/\\?]")+"*"),T=r(r(n+"|[\\/\\?]")+"*"),aq=r(r("\\/\\/"+h+a)+"|"+m+"|"+aw+"|"+b),W=r(d+"\\:"+aq+r("\\?"+o)+"?"+r("\\#"+T)+"?"),L=r(r("\\/\\/"+h+a)+"|"+m+"|"+at+"|"+b),q=r(L+r("\\?"+o)+"?"+r("\\#"+T)+"?"),s=r(W+"|"+q),au=r(d+"\\:"+aq+r("\\?"+o)+"?"),p=new RegExp("^"+r("("+W+")|("+q+")")+"$"),ak=new RegExp("^("+d+")\\:"+r(r("\\/\\/("+r("("+l+")@")+"?("+e+")"+r("\\:("+U+")")+"?)")+"?("+a+"|"+m+"|"+aw+"|"+b+")")+r("\\?("+o+")")+"?"+r("\\#("+T+")")+"?$"),J=new RegExp("^(){0}"+r(r("\\/\\/("+r("("+l+")@")+"?("+e+")"+r("\\:("+U+")")+"?)")+"?("+a+"|"+m+"|"+at+"|"+b+")")+r("\\?("+o+")")+"?"+r("\\#("+T+")")+"?$"),C=new RegExp("^("+d+")\\:"+r(r("\\/\\/("+r("("+l+")@")+"?("+e+")"+r("\\:("+U+")")+"?)")+"?("+a+"|"+m+"|"+aw+"|"+b+")")+r("\\?("+o+")")+"?$"),K=new RegExp("^"+r("\\#("+T+")")+"?$"),D=new RegExp("^"+r("("+l+")@")+"?("+e+")"+r("\\:("+U+")")+"?$"),ai=new RegExp(B("[^]",c,f,"[\\+\\-\\.]"),"g"),X=new RegExp(B("[^\\%\\:]",M,ah),"g"),av=new RegExp(B("[^\\%]",M,ah),"g"),O=new RegExp(B("[^\\%\\/\\:\\@]",M,ah),"g"),V=new RegExp(B("[^\\%\\/\\@]",M,ah),"g"),y=new RegExp(B("[^\\%]",M,ah,"[\\:\\@\\/\\?]"),"g"),G=y,R=new RegExp(B("[^]",M,ah),"g"),E=new RegExp(M,"g"),t=new RegExp(B("[^\\%]",M,F),"g"),P=new RegExp(ag+"+","g"),k=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?([^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/i,A=/^\.\.?\//,z=/^\/\.(\/|$)/,x=/^\/\.\.(\/|$)/,v=/^\.\.?$/,u=/^\/?.*?(?=\/|$)/,w=("").match(/(){0}/)[1]===undefined,j=function(ay){var az=ay.charCodeAt(0);if(az<128){return"%"+az.toString(16).toUpperCase()}else{if((az>127)&&(az<2048)){return"%"+((az>>6)|192).toString(16).toUpperCase()+"%"+((az&63)|128).toString(16).toUpperCase()}else{return"%"+((az>>12)|224).toString(16).toUpperCase()+"%"+(((az>>6)&63)|128).toString(16).toUpperCase()+"%"+((az&63)|128).toString(16).toUpperCase()}}},aj=function(aB){var ay="",az=0,aC,aA;while(az<aB.length){aC=parseInt(aB.substr(az+1,2),16);if(aC<128){aA=String.fromCharCode(aC);if(aA.match(E)){ay+=aA}else{ay+=aB.substr(az,3)}az+=3}else{if((aC>191)&&(aC<224)){ay+=aB.substr(az,6);az+=6}else{ay+=aB.substr(az,9);az+=9}}}return ay},g=function(aC){var az="",aB=0,aD,aA,ay;while(aB<aC.length){aD=parseInt(aC.substr(aB+1,2),16);if(aD<128){az+=String.fromCharCode(aD);aB+=3}else{if((aD>191)&&(aD<224)){aA=parseInt(aC.substr(aB+4,2),16);az+=String.fromCharCode(((aD&31)<<6)|(aA&63));aB+=6}else{aA=parseInt(aC.substr(aB+4,2),16);ay=parseInt(aC.substr(aB+7,2),16);az+=String.fromCharCode(((aD&15)<<12)|((aA&63)<<6)|(ay&63));aB+=9}}}return az},aa=function(ay){return ay===undefined?"undefined":(ay===null?"null":Object.prototype.toString.call(ay).split(" ").pop().split("]").shift().toLowerCase())},ac=function(){this.errors=[]},Z=exports;ac.prototype={scheme:undefined,authority:undefined,userinfo:undefined,host:undefined,port:undefined,path:undefined,query:undefined,fragment:undefined,reference:undefined,errors:undefined};Z.SCHEMES={};Z.parse=function(aC,ay){var aB,aA=new ac(),az;aC=aC?aC.toString():"";ay=ay||{};if(ay.reference==="suffix"){aC=(ay.scheme?ay.scheme+":":"")+"//"+aC}aB=aC.match(p);if(aB){if(aB[1]){aB=aC.match(ak)}else{aB=aC.match(J)}}if(!aB){if(!ay.tolerant){aA.errors.push("URI is not strictly valid.")}aB=aC.match(k)}if(aB){if(w){aA.scheme=aB[1];aA.authority=aB[2];aA.userinfo=aB[3];aA.host=aB[4];aA.port=parseInt(aB[5],10);aA.path=aB[6]||"";aA.query=aB[7];aA.fragment=aB[8];if(isNaN(aA.port)){aA.port=aB[5]}}else{aA.scheme=aB[1]||undefined;aA.authority=(aC.indexOf("//")!==-1?aB[2]:undefined);aA.userinfo=(aC.indexOf("@")!==-1?aB[3]:undefined);aA.host=(aC.indexOf("//")!==-1?aB[4]:undefined);aA.port=parseInt(aB[5],10);aA.path=aB[6]||"";aA.query=(aC.indexOf("?")!==-1?aB[7]:undefined);aA.fragment=(aC.indexOf("#")!==-1?aB[8]:undefined);if(isNaN(aA.port)){aA.port=(aC.match(/\/\/.*\:(?:\/|\?|\#|$)/)?aB[4]:undefined)}}if(!aA.scheme&&!aA.authority&&!aA.path&&!aA.query){aA.reference="same-document"}else{if(!aA.scheme){aA.reference="relative"}else{if(!aA.fragment){aA.reference="absolute"}else{aA.reference="uri"}}}if(ay.reference&&ay.reference!=="suffix"&&ay.reference!==aA.reference){aA.errors.push("URI is not a "+ay.reference+" reference.")}az=Z.SCHEMES[(aA.scheme||ay.scheme||"").toLowerCase()];if(az&&az.parse){az.parse(aA,ay)}}else{aA.errors.push("URI can not be parsed.")}return aA};Z._recomposeAuthority=function(az){var ay=[];if(az.userinfo!==undefined||az.host!==undefined||typeof az.port==="number"){if(az.userinfo!==undefined){ay.push(az.userinfo.toString().replace(X,j));ay.push("@")}if(az.host!==undefined){ay.push(az.host.toString().toLowerCase().replace(av,j))}if(typeof az.port==="number"){ay.push(":");ay.push(az.port.toString(10))}}return ay.length?ay.join(""):undefined};Z.removeDotSegments=function(az){var ay=[],aA;while(az.length){if(az.match(A)){az=az.replace(A,"")}else{if(az.match(z)){az=az.replace(z,"/")}else{if(az.match(x)){az=az.replace(x,"/");ay.pop()}else{if(az==="."||az===".."){az=""}else{aA=az.match(u)[0];az=az.slice(aA.length);ay.push(aA)}}}}}return ay.join("")};Z.serialize=function(aC,ay){var aA=[],az,aB;ay=ay||{};az=Z.SCHEMES[aC.scheme||ay.scheme];if(az&&az.serialize){az.serialize(aC,ay)}if(ay.reference!=="suffix"&&aC.scheme){aA.push(aC.scheme.toString().toLowerCase().replace(ai,""));aA.push(":")}aC.authority=Z._recomposeAuthority(aC);if(aC.authority!==undefined){if(ay.reference!=="suffix"){aA.push("//")}aA.push(aC.authority);if(aC.path&&aC.path.charAt(0)!=="/"){aA.push("/")}}if(aC.path){aB=Z.removeDotSegments(aC.path.toString().replace(/%2E/ig,"."));if(aC.scheme){aB=aB.replace(O,j)}else{aB=aB.replace(V,j)}if(aC.authority===undefined){aB=aB.replace(/^\/\//,"/%2F")}aA.push(aB)}if(aC.query){aA.push("?");aA.push(aC.query.toString().replace(y,j))}if(aC.fragment){aA.push("#");aA.push(aC.fragment.toString().replace(G,j))}return aA.join("").replace(P,aj).replace(/%[0-9A-Fa-f]{2}/g,function(aD){return aD.toUpperCase()})};Z.resolveComponents=function(aA,az,ay,aC){var aB=new ac();if(!aC){aA=Z.parse(Z.serialize(aA,ay),ay);az=Z.parse(Z.serialize(az,ay),ay)}ay=ay||{};if(!ay.tolerant&&az.scheme){aB.scheme=az.scheme;aB.authority=az.authority;aB.userinfo=az.userinfo;aB.host=az.host;aB.port=az.port;aB.path=Z.removeDotSegments(az.path);aB.query=az.query}else{if(az.authority!==undefined){aB.authority=az.authority;aB.userinfo=az.userinfo;aB.host=az.host;aB.port=az.port;aB.path=Z.removeDotSegments(az.path);aB.query=az.query}else{if(!az.path){aB.path=aA.path;if(az.query!==undefined){aB.query=az.query}else{aB.query=aA.query}}else{if(az.path.charAt(0)==="/"){aB.path=Z.removeDotSegments(az.path)}else{if(aA.authority!==undefined&&!aA.path){aB.path="/"+az.path}else{if(!aA.path){aB.path=az.path}else{aB.path=aA.path.slice(0,aA.path.lastIndexOf("/")+1)+az.path}}aB.path=Z.removeDotSegments(aB.path)}aB.query=az.query}aB.authority=aA.authority;aB.userinfo=aA.userinfo;aB.host=aA.host;aB.port=aA.port}aB.scheme=aA.scheme}aB.fragment=az.fragment;return aB};Z.resolve=function(aA,az,ay){return Z.serialize(Z.resolveComponents(Z.parse(aA,ay),Z.parse(az,ay),ay,true),ay)};Z.normalize=function(az,ay){if(typeof az==="string"){return Z.serialize(Z.parse(az,ay),ay)}else{if(aa(az)==="object"){return Z.parse(Z.serialize(az,ay),ay)}}return az};Z.equal=function(aA,az,ay){if(typeof aA==="string"){aA=Z.serialize(Z.parse(aA,ay),ay)}else{if(aa(aA)==="object"){aA=Z.serialize(aA,ay)}}if(typeof az==="string"){az=Z.serialize(Z.parse(az,ay),ay)}else{if(aa(az)==="object"){az=Z.serialize(az,ay)}}return aA===az};Z.escapeComponent=function(ay){return ay&&ay.toString().replace(R,j)};Z.unescapeComponent=function(ay){return ay&&ay.toString().replace(P,g)};exports.pctEncChar=j;exports.pctDecChars=g;exports.Components=ac;exports.URI=Z;exports.pctEncChar=j;exports.pctDecChars=g;exports.Components=ac;exports.URI={SCHEMES:Z.SCHEMES,parse:Z.parse,removeDotSegments:Z.removeDotSegments,serialize:Z.serialize,resolveComponents:Z.resolveComponents,resolve:Z.resolve,normalize:Z.normalize,equal:Z.equal,escapeComponent:Z.escapeComponent,unescapeComponent:Z.unescapeComponent}}());